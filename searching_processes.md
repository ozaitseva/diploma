#Поиск процессов в дампе памяти



Каждый процесс в Windows представлен структурой __EPROCESS_. Данная структура содержит атрибуты, 
описывающие процесс, а также другие связанные с ним структуры данных, например, для описания потоков процессов используется 
структура __ETHREAD_. Данные структуры __EPROCESS_ хранятся в адресном пространстве ядра, за исключением блока переменных
 окружения (process environment block (PEB)). Первым элементом структуры процесса является блок управления процессом, 
представленный структурой __KPROCESS_ и хранящейся также в пространстве ядра. Структуры __KPROCESS_ и __KTHREAD_ начинаются 
с субструктуры, известной как __DISPATCHER_HEADER_. В данной подструктуре содержатся атрибуты _TYPE_ и _SIZE_, определяющие 
тип и размер объекта соответственно, которые принимают одинаковые значения для всех процессов конкретной операционной системы.[1]
 Для Windows 7 значение поля _TYPE_ равно **0x03**, значение поля _SIZE_  - **0x26**. Найдя данные значения в образе памяти –
 в адресном пространстве ядра, можно найти структуру __EPROCESS_. Одним из недостатков данного подхода является тот факт, что 
с помощью данного метода можно найти только структуры процессов и потоков. Найдя структуру процесса, по значению поля
 _DirectoryTableBase_, хранящегося в структуре __KPROCESS_, можно получить физический адрес таблицы преобразования 
четвертого уровня PML4, а по значениям полей _ThreadListHead.Flink_ и _ThreadListHead.Blink_ виртуальные адреса предыдущего
 и последующего процессов соответственно. Данные поля должны содержать значения, соответствующие адресному процессу ядра.[2]



##Литература:



[1] Michael Hale Ligh, Andrew Case, Jamie Levy, AAron Walters, The Art of Memory Forensics: Detecting Malware and Threats in Windows,
 Linux, and Mac Memory, P.146-147



[2] Andreas Schuster, Searching for processes and threads in Microsoft Windows memory dumps, Digital Investigation, 2006, 
Vol. 3, P. 10-16.


